NETWORK-SECURITY




#### INFORMATION GATHERING ####




HOST DISCOVERY

nmap -sn ip    (ping sweep)
nmap -n -sn -PS22,135,443,445   (no ping)

nmap -sS -sU -p53 IP	(DNS Discovery)

DNS
nslookup
server IP (DNS)
set q=NS/MX/A    NS=NameServer/MX=Mail/A=Finding records/hosts
domain.com

ZONE-TRANSFER
dig @IP domain.com -t AXFR +nocookie
host -t axfr domain.com DNS-IP

SCANNING
nmap -PE -sn -n targetIP -oX /root/Documents/discovery/discoveryscan.xml // ICMP echo request scan without port scan and save results into an XML file

nmap -sU targetIP // UDP Scan

nmap -sS -iL /root/Documents/discovery/discoveryscan.txt // TCP port scan of targets in the txt file

nmap -sS --source-port portNumber -p portNumber targetIP

nmap -O -v -n targetIP --osscan-guess // OS fingerprinting

nmap -sV targetIP // Service detection

nmap -O -v -n targetIP // finding a zombie -- result must be: IP ID Sequence Generation: Incremental for a good zombie

nmap -Pn -sI zombieIP:openport targetIP -v




#### ENUMERATION ####




Netbios
nbstat -A // gaterhing netbios information, execute this command directly on Windows systems

net view IP // execute this command directly on Windows systems to list all shares

net use K: \\IP\sharename // add K drive to mapped source

nbtscan -v targetIP // gather Netbios information

smbclient -L targetIP // list all shares

enum4linux targetIP // gather information about smb

rpcclient -N -U "" targetIP // execute rrmote RPC without asking for password en set the network username

mount.cifs //targetIP/share /media/K_share/ user=,pass= // mount drive K on linux

Null Session
net use \\IP\IPC$ "" /u:"" // test for anonymous NULL session

SNMP 
snmpwalk -v 2c targetIP -c public // snmp enumeration
nmap -sU -p 161 --script=snmp-win32-services targetIP // snmp enumeration
nmap -sU -p 161 targetIP --script snmp-brute // find community string
